<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculadora de Alfa de Cronbach</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">

<!-- ESTILIZA√á√ÉO CSS -->
<style>
    * { 
	box-sizing: border-box; 
	margin: 0; 
	padding: 0; 
	font-family: 'Inter', sans-serif; 
	}

    body { 
	background-color: #f0f4f8; 
	display: flex; 
	justify-content: center; 
	align-items: flex-start; 
	min-height: 100vh; 
	padding: 40px; 
	}

    .app-container { 
	background-color: #fff; 
	padding: 40px;
	border-radius: 16px; 
	box-shadow: 0 8px 20px rgba(0,0,0,0.1); 
	max-width: 600px; width: 100%;
	}


    h1 { 
	text-align: center; 
	margin-bottom: 30px; 
	color: #1f2937; 
        }

    .card { 
	background-color: #f9fafb; 
	padding: 20px; 
	border-radius: 12px; 
	margin-bottom: 20px; 
	box-shadow: 0 4px 10px rgba(0,0,0,0.05); 
	transition: 0.3s; 
        }

    .card:hover { 
	box-shadow: 0 6px 15px rgba(0,0,0,0.1); 
        }
    
    input[type="file"], select, button { 
	width: 100%; 
	padding: 12px 16px; 
	border-radius: 
	8px; border: 1px solid #d1d5db; 
	margin-top: 12px; 
	font-size: 16px; 
        }

    button { 
	background-color: #3b82f6; 
	color: white; 
	border: none; 
	cursor: pointer; 
	font-weight: 600; 
	transition: 0.3s; 
        }

    button:hover { 
	background-color: #2563eb; 
        }

    #resultado { 
	margin-top: 20px; 
	padding: 20px; 
	border-radius: 12px; 
	background-color: #e0f2fe; 
	color: #0369a1; 
	font-weight: 600; 
	text-align: center; 
	font-size: 18px; 
	box-shadow: 0 4px 10px rgba(0,0,0,0.05); 
        }

    .imagem-responsiva {
	max-width: 100%; /* Garante que a imagem nunca ultrapasse a largura do seu cont√™iner */
    height: auto;    /* Ajusta a altura automaticamente para manter a propor√ß√£o original */
    display: block;  /* Ajuda a remover espa√ßos indesejados abaixo da imagem (comum com elementos inline) */
        }

</style>

<!--CORPO DA WEBPAGE -->
</head>
<body>


<div class="app-container">
    <h1>Calculadora de Alfa de Cronbach</h1><br>
    <h5> By: Ira√™ C√©sar Brand√£o - Dev </h5>
    <hr>
    <div class="card">
        <label>üìÇ Envie sua planilha Excel:</label>
        <input type="file" id="fileInput" accept=".xlsx">
    </div>

    <div class="card" style="display:none;" id="sheetCard">
        <label>üìë Selecione a aba:</label>
        <select id="sheetSelect"></select>
    </div>

<b> Passos para o uso da calculadora:</b>
<br><br>
     <h5 style="text-align: justify;">
	1) Primeiramente dever√° fazer download da planilha (que j√° est√° previamente preenchida), basta 	clicar neste link  para descarregar a planilha:
	<a href="ferramenta_aig_com_dados.xlsx"> ferramenta_aig_com_dados.xlsx</a>; <br>
	2) Esta segunda planilha tem 20 estudantes, para testes com mais estudantes. <br>
    <a href="ferramenta_aig_com_dados2.xlsx"> ferramenta_aig_com_dados2.xlsx</a>; <br>
	3) Ele ir√° para a sua pasta Download em seu computador, basta ir no bot√£o "Escolher arquivo", 	buscar o arquivo na pasta e importa-lo; <br>

	4) Aparecer√° abaixo "Selecionar aba", escolha pelo menu o √≠tem "Responses"; <br>

	5) Ap√≥s basta clicar em "Calcular Alfa" que o resultado ser√° apresentado logo abaixo:</h5>

    <div class="card" style="display:none;" id="calcCard">
        <button id="calcBtn">Calcular Alfa</button>
    </div>

    <div id="resultado"></div>


<hr>
<br>

<!-- ORIENTA√á√ïES SOBRE USO E C√ìDIGO -->

<div >
<h2> SOBRE O APP </h2> <br>
<h4> Linguagens utilizadas</h4>
<br>

<h6>
<ul>
<li> HTML = estrutura </li>
<li> CSS = apar√™ncia </li>
<li> JavaScript = l√≥gica e c√°lculos e a l√≥gica do aplicativo, incluindo: </li>
     - Ler a planilha Excel usando SheetJS (XLSX.js);
<br> - Identificar as colunas dos itens; 
<br> - Fazer os c√°lculos (vari√¢ncia, soma, alfa de Cronbach);
<br> - Mostrar o resultado na tela.
<li> EXCEL -  Programa Microsfot Office (Planilha Excel)  Office (Planilha xlsx) 
<br><br>

<img class="imagem-responsiva" src="fig6.jpg" alt="Descri√ß√£o da imagem"></img><br>

<br><br><hr>
</h6><br>
<h4> O que √© o Alfa de Cronbach </h4><br>

<img class="imagem-responsiva" src="fig3.jpg" alt="Descri√ß√£o da imagem"></img>

<br><br>
<h6 style="text-align: justify;">
O Alfa de Cronbach √© uma medida de confiabilidade que avalia a consist√™ncia interna de um conjunto de itens, como as perguntas de um question√°rio. Ele verifica o quanto os itens de uma escala est√£o relacionados entre si e medem o mesmo construto subjacente, como a satisfa√ß√£o do cliente ou a autoestima. Um valor alto indica que os itens s√£o consistentes, enquanto um valor baixo pode indicar que os itens n√£o est√£o medindo a mesma coisa ou que s√£o inconsistentes. ¬†                  Como funciona     Avalia a consist√™ncia interna: O alfa de Cronbach mede o grau em que os itens de uma escala concordam entre si.¬† Indica confiabilidade: √â uma medida da confiabilidade da escala, ou seja, a extens√£o em que ela √© uma medida consistente de um conceito.¬† Correla√ß√£o entre itens: Ele √© calculado com base nas correla√ß√µes entre os itens da escala. Quanto mais correlacionados os itens estiverem, maior ser√° o valor do alfa.¬† Escala de 0 a 1: Teoricamente, o valor do alfa varia de \(0\) a \(1\). Valores a partir de \(0,70\) s√£o geralmente considerados aceit√°veis, com valores mais altos indicando maior confiabilidade.¬† Limita√ß√µes: O alfa de Cronbach pode ser baixo se houver poucos itens na escala ou se os itens forem muito heterog√™neos.¬†<br>
<br>

Refer√™ncia: 
</h6>
<a href="https://en.wikipedia.org/wiki/Cronbach%27s_alpha" target="_blank"> <h5><b>Alfa de Cronbach. Wikipedia:</h5> </a> <br>

<br><hr><br>

<h2 > ROTINAS DO APP </h2> <br>
</h6>
<h4>(1) O que o HTML faz (Resumo)</h4>
<br>
<h6 style="text-align: justify;">
O arquivo HTML criado para voc√™ funciona como um miniaplicativo web.  

<br>1 ‚Äî Permite enviar um arquivo Excel (.xlsx): O usu√°rio clica em ‚ÄúEnviar planilha‚Äù e escolhe o arquivo.
 <br> 

<br>2 ‚Äî L√™ o arquivo no navegador. Usa a biblioteca SheetJS (XLSX.js) para:
	<br> - Ler o conte√∫do da planilha;
	<br> - Descobrir quais abas existem;
	<br> - Permitir ao usu√°rio escolher uma delas.
<br>
- Link para baixar a planilha:
<a href="ferramenta_aig_com_dados.xlsx">ferramenta_aig_com_dados.xlsx</a> <br>


<br>3 ‚Äî Identifica colunas que come√ßam com ‚ÄúItem‚Äù <br>
Qualquer coluna cujo nome comece com: <br>
Item
	<br>item
	<br>ITEM
	<br>item1
	<br>Item_01
	<br> √© considerada um item da escala.

<br>
<br>4 ‚Äî Extrai somente essas colunas: <br>
O aplicativo pega apenas as colunas dos itens e converte os valores para n√∫meros.<br>

<br>5 ‚Äî Calcula o Alfa de Cronbach em JavaScript: <br>
A l√≥gica matem√°tica √© aplicada dentro do navegador, sem servidor. <br>

<br>6 ‚Äî Mostra o resultado estilizado na tela: <br>
- Exibe algo como:<br>
<i><b>Alfa de Cronbach: 0.8421 </b></i>
</h6>

<br><br>
<hr>
<br>

<h4><b> (2) Como o c√°lculo do Alfa de Cronbach funciona (Resumo direto)</b></h4><br>
<h6 style="text-align: justify;">
<ul>
<li> O Alfa de Cronbach mede se os itens da escala avaliam o mesmo construto, ou seja, se s√£o consistentes internamente.
O c√°lculo segue esta f√≥rmula:</li>
onde:<br>
 
<img class="imagem-responsiva" src="fig1.jpg" alt="Descri√ß√£o da imagem"></img><br>

	‚Ä¢ k = n√∫mero de itens<br>
	‚Ä¢ Var(itens) = vari√¢ncia de cada item individual <br>
	‚Ä¢ Var(total) = vari√¢ncia da soma dos itens de cada participante <br>
</h6>

<br><br>

<hr><br>

<h4><b>(3) Passos que o c√≥digo segue:</b></h4>
<h6>
<br> 1 ‚Äî Calcula a vari√¢ncia de cada item (Var(item))
Para cada coluna Item1, Item2, Item3‚Ä¶ 

<br>
<br> 2 ‚Äî Soma essas vari√¢ncias: <br><br>
</h6>
	<h3>‚àëVar(item)</h3>
<h6>
<br> 
<br> 3 ‚Äî Soma os itens por linha (pessoa por pessoa)
	<br>Exemplo:
<br><br>
	<img class="imagem-responsiva" src="fig4.jpg" alt="Descri√ß√£o da imagem"></img><br>
<br><br>


<br> 4 ‚Äî Calcula a vari√¢ncia dos totais (Var(total))
<br>

<br> 5 ‚Äî Aplica a f√≥rmula
	<br>Com todo mundo respondido, aplica: <br>
	<img class="imagem-responsiva" src="fig2.jpg" alt="Descri√ß√£o da imagem"></img><br>
<br>

<br>6 ‚Äî Finalmente: O resultado final √© o alfa. 
<br><br>
	<img class="imagem-responsiva" src="fig5.jpg" alt="Descri√ß√£o da imagem"></img><br>

</div>
<br><br>
<footer>
	<h6 style="color:blue;  border: 2px solid blue;"><i>¬© 2025. All rights reserved LUCK WAY¬Æ Inform√°tica -  Developed by: Ira√™ C√©sar Brand√£o</i></h6>
</footer>

</div>
<br>

<!-- SCRIPT JAVA -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
    let workbook;

    document.getElementById('fileInput').addEventListener('change', (e) => {
        const file = e.target.files[0];
        const reader = new FileReader();
        reader.onload = (evt) => {
            const data = new Uint8Array(evt.target.result);
            workbook = XLSX.read(data, {type: 'array'});
            const sheetSelect = document.getElementById('sheetSelect');
            sheetSelect.innerHTML = '';
            workbook.SheetNames.forEach(name => {
                const option = document.createElement('option');
                option.value = name;
                option.text = name;
                sheetSelect.appendChild(option);
            });
            document.getElementById('sheetCard').style.display = 'block';
            document.getElementById('calcCard').style.display = 'block';
            document.getElementById('resultado').innerHTML = '';
        };
        reader.readAsArrayBuffer(file);
    });

    function calculateAlpha(data) {
        const k = data[0].length;
        const n = data.length;

        let itemVars = [];
        for(let j=0; j<k; j++){
            let col = data.map(row => row[j]);
            let mean = col.reduce((a,b)=>a+b,0)/n;
            let varCol = col.reduce((a,b)=>a + (b-mean)**2, 0)/(n-1);
            itemVars.push(varCol);
        }

        let totalScores = data.map(row => row.reduce((a,b)=>a+b,0));
        let meanTotal = totalScores.reduce((a,b)=>a+b,0)/n;
        let totalVar = totalScores.reduce((a,b)=>a + (b-meanTotal)**2, 0)/(n-1);

        const alpha = (k/(k-1)) * (1 - (itemVars.reduce((a,b)=>a+b,0)/totalVar));
        return alpha;
    }

    document.getElementById('calcBtn').addEventListener('click', () => {
        const sheetName = document.getElementById('sheetSelect').value;
        const ws = workbook.Sheets[sheetName];
        const jsonData = XLSX.utils.sheet_to_json(ws, {header:1});
        const headers = jsonData[0];

        const itemCols = headers.map((h,i)=> h.toLowerCase().startsWith("item") ? i : -1).filter(i=>i>=0);
        if(itemCols.length === 0){
            alert("Nenhuma coluna 'Item' encontrada.");
            return;
        }

        const data = jsonData.slice(1).map(row => itemCols.map(i => parseFloat(row[i])));
        const alpha = calculateAlpha(data);

        document.getElementById('resultado').innerHTML = `üßÆ <strong>Alfa de Cronbach:</strong> ${alpha.toFixed(4)}`;
    });
</script>


</body>
</html>




